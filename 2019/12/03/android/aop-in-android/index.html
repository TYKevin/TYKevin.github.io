<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.8.0">
    

    
<!-- Tencent Speed -->
<script>var _speedMark = new Date()</script>
<!-- End Tencent Speed -->
<!-- Tencent Analysis -->
<script async src="//tajs.qq.com/stats?sId=65833954"></script>
<!-- End Tencent Analysis -->


    
<!-- Baidu Tongji -->
<script>var _hmt = _hmt || []</script>
<script async src="//hm.baidu.com/hm.js?6d520a13e84c06ff07f5a966d25be3aa"></script>
<!-- End Baidu Tongji -->




    <meta charset="utf-8">
    
    
    
    
    <title>重构登录管理 - AOP 思想在 Android 中的应用 | Android 进阶指北 | 刻意练习，未来可期</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    
    <meta name="theme-color" content="#0F2143">
    
    
    <meta name="keywords" content="android 进阶,android 架构">
    <meta name="description" content="什么是AOP？首先我们需要来了解下，什么是 AOP？AOP 全名是 Aaspect Oriented Programming, 即面向切面编程。我认为 AOP 是在 OOP 思想上的延续。我们可以通过 利用 AOP，对很多重复的业务在横向切掉并抽离出来，例如日志打印，埋点统计，以及我们今天的例子登录管理等等。AOP 在 Java 后端中非常普及了，今天我们从一个例子由浅入深，来看看 AOP 在 A">
<meta name="keywords" content="android 进阶,android 架构">
<meta property="og:type" content="article">
<meta property="og:title" content="重构登录管理 - AOP 思想在 Android 中的应用">
<meta property="og:url" content="http://TYKevin.github.io/2019/12/03/android/aop-in-android/index.html">
<meta property="og:site_name" content="Android 进阶指北">
<meta property="og:description" content="什么是AOP？首先我们需要来了解下，什么是 AOP？AOP 全名是 Aaspect Oriented Programming, 即面向切面编程。我认为 AOP 是在 OOP 思想上的延续。我们可以通过 利用 AOP，对很多重复的业务在横向切掉并抽离出来，例如日志打印，埋点统计，以及我们今天的例子登录管理等等。AOP 在 Java 后端中非常普及了，今天我们从一个例子由浅入深，来看看 AOP 在 A">
<meta property="og:locale" content="zh-CN">
<meta property="og:updated_time" content="2019-12-03T16:39:34.010Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="重构登录管理 - AOP 思想在 Android 中的应用">
<meta name="twitter:description" content="什么是AOP？首先我们需要来了解下，什么是 AOP？AOP 全名是 Aaspect Oriented Programming, 即面向切面编程。我认为 AOP 是在 OOP 思想上的延续。我们可以通过 利用 AOP，对很多重复的业务在横向切掉并抽离出来，例如日志打印，埋点统计，以及我们今天的例子登录管理等等。AOP 在 Java 后端中非常普及了，今天我们从一个例子由浅入深，来看看 AOP 在 A">
    
        <link rel="alternate" type="application/atom+xml" title="Android 进阶指北" href="/atom.xml">
    
    <link rel="shortcut icon" href="/favicon.ico">
    <link rel="stylesheet" href="/css/style.css?v=1.7.2">
    <script>window.lazyScripts=[]</script>

    <!-- custom head -->
    

</head>

<body>
    <div id="loading" class="active"></div>

    <aside id="menu" class="hide">
  <div class="inner flex-row-vertical">
    <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menu-off">
        <i class="icon icon-lg icon-close"></i>
    </a>
    <div class="brand-wrap" style="background-image:url(/img/brand.jpg)">
      <div class="brand">
        <a href="/" class="avatar waves-effect waves-circle waves-light">
          <img src="/img/avatar.png">
        </a>
        <hgroup class="introduce">
          <h5 class="nickname">童煜</h5>
          <a href="mailto:tongyu.nj@gmail.com" title="tongyu.nj@gmail.com" class="mail">tongyu.nj@gmail.com</a>
        </hgroup>
      </div>
    </div>
    <div class="scroll-wrap flex-col">
      <ul class="nav">
        
            <li class="waves-block waves-effect">
              <a href="/">
                <i class="icon icon-lg icon-home"></i>
                主页
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/archives">
                <i class="icon icon-lg icon-archives"></i>
                Archives
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/tags">
                <i class="icon icon-lg icon-tags"></i>
                Tags
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/categories">
                <i class="icon icon-lg icon-th-list"></i>
                Categories
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="https://github.com/tykevin" target="_blank">
                <i class="icon icon-lg icon-github"></i>
                Github
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="https://stackoverflow.com/users/8170135/tykevin" target="_blank">
                <i class="icon icon-lg icon-stack-overflow"></i>
                Stack Overflow
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="https://www.zhihu.com/people/tong-yu-49-81" target="_blank">
                <i class="icon icon-lg icon-link"></i>
                知乎
              </a>
            </li>
        
      </ul>
    </div>
  </div>
</aside>

    <main id="main">
        <header class="top-header" id="header">
    <div class="flex-row">
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light on" id="menu-toggle">
          <i class="icon icon-lg icon-navicon"></i>
        </a>
        <div class="flex-col header-title ellipsis">重构登录管理 - AOP 思想在 Android 中的应用</div>
        
        <div class="search-wrap" id="search-wrap">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="back">
                <i class="icon icon-lg icon-chevron-left"></i>
            </a>
            <input type="text" id="key" class="search-input" autocomplete="off" placeholder="输入感兴趣的关键字">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="search">
                <i class="icon icon-lg icon-search"></i>
            </a>
        </div>
        
        
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menuShare">
            <i class="icon icon-lg icon-share-alt"></i>
        </a>
        
    </div>
</header>
<header class="content-header post-header">
    <div class="header-title-bar">
        <div class="header-title-bar-text">
            <div class="header-superoid fade">
                <img src="/img/superoid-logo-small.png">
            </div>

            <div class="fade-scale content-header-titles">
                <h1 class="title">重构登录管理 - AOP 思想在 Android 中的应用</h1>
                <h5 class="subtitle">
                    
                        <time datetime="2019-12-03T14:39:39.000Z" itemprop="datePublished" class="page-time">
  2019-12-03
</time>


                    
                </h5>
            </div>
        </div>
        <div class="fade-scale header-qrcode">
            <img src="/img/qrcode_for_wx.png">
        </div>
    </div>  

    

</header>


<div class="container body-wrap">
    
    <aside class="post-widget">
        <nav class="post-toc-wrap post-toc-shrink" id="post-toc">
            <h4>TOC</h4>
            <ol class="post-toc"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#什么是AOP？"><span class="post-toc-number">1.</span> <span class="post-toc-text">什么是AOP？</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#运行时织入：通过动态代理实现-AOP"><span class="post-toc-number">2.</span> <span class="post-toc-text">运行时织入：通过动态代理实现 AOP</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#编译时织入：通过-AspectJ-实现集中式登录框架"><span class="post-toc-number">3.</span> <span class="post-toc-text">编译时织入：通过 AspectJ 实现集中式登录框架</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#添加插件"><span class="post-toc-number">3.0.1.</span> <span class="post-toc-text">添加插件</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#APP-编译设置"><span class="post-toc-number">3.0.2.</span> <span class="post-toc-text">APP 编译设置</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#新增连接点标示"><span class="post-toc-number">3.0.3.</span> <span class="post-toc-text">新增连接点标示</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#添加连接点"><span class="post-toc-number">3.0.4.</span> <span class="post-toc-text">添加连接点</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#添加切面"><span class="post-toc-number">3.0.5.</span> <span class="post-toc-text">添加切面</span></a></li></ol></li></ol>
        </nav>
    </aside>


<article id="post-android/aop-in-android" class="post-article article-type-post fade" itemprop="blogPost">

    <div class="post-card">
        <h1 class="post-card-title">重构登录管理 - AOP 思想在 Android 中的应用</h1>
        <div class="post-meta">
            <time class="post-time" title="2019-12-03 22:39:39" datetime="2019-12-03T14:39:39.000Z" itemprop="datePublished">2019-12-03</time>

            


            
<span id="busuanzi_container_page_pv" title="文章总阅读量" style="display:none">
    <i class="icon icon-eye icon-pr"></i><span id="busuanzi_value_page_pv"></span>
</span>


        </div>
        <div class="post-content" id="post-content" itemprop="postContent">
            <h2 id="什么是AOP？"><a href="#什么是AOP？" class="headerlink" title="什么是AOP？"></a>什么是AOP？</h2><p>首先我们需要来了解下，什么是 AOP？AOP 全名是 Aaspect Oriented Programming, 即面向切面编程。我认为 AOP 是在 OOP 思想上的延续。我们可以通过 利用 AOP，对很多重复的业务在横向切掉并抽离出来，例如日志打印，埋点统计，以及我们今天的例子登录管理等等。AOP 在 Java 后端中非常普及了，今天我们从一个例子由浅入深，来看看 AOP 在 Android 中可以如何应用。</p>
<p>首先我们从例子入手：我们现在有个需求，需要在数据插入数据库之前都对数据进行一次保存操作，如果在没有接触 AOP 之前，我们是如何操作呢？这里我么来简单的举个例子:</p>
<h2 id="运行时织入：通过动态代理实现-AOP"><a href="#运行时织入：通过动态代理实现-AOP" class="headerlink" title="运行时织入：通过动态代理实现 AOP"></a>运行时织入：通过动态代理实现 AOP</h2><p>假设我们有个数据库操作接口 <code>DBOperation</code>:<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">DBOperation</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">insert</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">delete</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">update</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">save</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>然后有个 Activity, 有个按钮模拟点击后，操作数据库，如果要实现需求，我们必须在每次操作前都调用一遍 <code>db.save()</code>  方法：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MainActivity</span> <span class="keyword">extends</span> <span class="title">AppCompatActivity</span> <span class="keyword">implements</span> <span class="title">DBOperation</span>, <span class="title">View</span>.<span class="title">OnClickListener</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String TAG = <span class="string">"MainActivity"</span>;</span><br><span class="line">    <span class="keyword">private</span> DBOperation db;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle savedInstanceState)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState);</span><br><span class="line">        setContentView(R.layout.activity_main);</span><br><span class="line">        db = <span class="keyword">this</span>;</span><br><span class="line"></span><br><span class="line">        findViewById(R.id.btn_operationDb).setOnClickListener(<span class="keyword">this</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">databaseOperating</span><span class="params">(View view)</span> </span>&#123;</span><br><span class="line">        db.save();</span><br><span class="line">        db.insert();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">insert</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        Log.d(TAG, <span class="string">"数据库操作：insert()"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">delete</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        Log.d(TAG, <span class="string">"数据库操作：delete()"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">update</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        Log.d(TAG, <span class="string">"数据库操作：update()"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">save</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        Log.d(TAG, <span class="string">"数据库操作：save()"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onClick</span><span class="params">(View v)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> viewId = v.getId();</span><br><span class="line">        <span class="keyword">switch</span> (viewId) &#123;</span><br><span class="line">            <span class="keyword">case</span> R.id.btn_operationDb:</span><br><span class="line">                databaseOperating(v);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>如果像例子中只有一次还好，如果每次要多次调用数据库的情况，则会造成代码的冗余以及有可能造成的遗忘。所以我们有没有办法在我们调用 insert/delete/update 的方法前就自动的调用一下 <code>save()</code> 方法呢？ 当然是有的，请看下面：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MainActivity</span> <span class="keyword">extends</span> <span class="title">AppCompatActivity</span> <span class="keyword">implements</span> <span class="title">DBOperation</span>, <span class="title">View</span>.<span class="title">OnClickListener</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String TAG = <span class="string">"MainActivity"</span>;</span><br><span class="line">    <span class="keyword">private</span> DBOperation db;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle savedInstanceState)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState);</span><br><span class="line">        setContentView(R.layout.activity_main);</span><br><span class="line"></span><br><span class="line">        findViewById(R.id.btn_operationDb).setOnClickListener(<span class="keyword">this</span>);</span><br><span class="line"></span><br><span class="line">        db = (DBOperation) Proxy.newProxyInstance(DBOperation.class.getClassLoader(), <span class="keyword">new</span> Class[]&#123;DBOperation.class&#125;, <span class="keyword">new</span> DBHandler(<span class="keyword">this</span>));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 操作数据库</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> view</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">databaseOperating</span><span class="params">(View view)</span> </span>&#123;</span><br><span class="line">        db.insert();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">insert</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        Log.d(TAG, <span class="string">"数据库操作：insert()"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">delete</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        Log.d(TAG, <span class="string">"数据库操作：delete()"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">update</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        Log.d(TAG, <span class="string">"数据库操作：update()"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">save</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        Log.d(TAG, <span class="string">"数据库操作：save()"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onClick</span><span class="params">(View v)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> viewId = v.getId();</span><br><span class="line">        <span class="keyword">switch</span> (viewId) &#123;</span><br><span class="line">            <span class="keyword">case</span> R.id.btn_operationDb:</span><br><span class="line">                databaseOperating(v);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 动态代理</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="class"><span class="keyword">class</span> <span class="title">DBHandler</span> <span class="keyword">implements</span> <span class="title">InvocationHandler</span> </span>&#123;</span><br><span class="line">        <span class="keyword">private</span> DBOperation db;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">DBHandler</span><span class="params">(DBOperation dbOperation)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">this</span>.db = dbOperation;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> Object <span class="title">invoke</span><span class="params">(Object proxy, Method method, Object[] args)</span> <span class="keyword">throws</span> Throwable </span>&#123;</span><br><span class="line">            <span class="keyword">if</span>(db != <span class="keyword">null</span>) &#123;</span><br><span class="line">                <span class="keyword">if</span> (!<span class="string">"save"</span>.equals(method.getName())) &#123;</span><br><span class="line">                    Log.d(TAG, <span class="string">"操作数据库之前，开始备份。。。"</span>);</span><br><span class="line">                    save();</span><br><span class="line">                    Log.d(TAG, <span class="string">"数据库备份完成。。。"</span>);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">return</span> method.invoke(db, args);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>上面的代码中使用到了 Java 的动态代理，在每次调用 <code>DBOperation</code> 接口中的方法时，都会去自动调用一遍 <code>save()</code> 方法，如此一来，我们在代码中只要调用到了 insert/update/delete 方法，则自动就会调用 <code>save()</code> 方法，这就是一个简单的 AOP 的实现，将 save 的操作 “横切” 出来，做成一个整体， 在 <strong>运行时织入</strong> 代码。</p>
<h2 id="编译时织入：通过-AspectJ-实现集中式登录框架"><a href="#编译时织入：通过-AspectJ-实现集中式登录框架" class="headerlink" title="编译时织入：通过 AspectJ 实现集中式登录框架"></a>编译时织入：通过 AspectJ 实现集中式登录框架</h2><p>那么除了上面运行时织入代码的方法，我们还能将”切出来的代码” 在编译时织入，在类加载时织入。下面我们着重介绍下今天的主角，AspectJ 框架。这是一个功能非常强大且好用的 AOP 框架，AspectJ 可以替代 javac 完成编译工作，并支持在编译期生成 class 文件时将代码织入对应的切入点。下面我们还是从实际的例子出发，来看看 AspectJ 在 Android 中如何应用的。</p>
<p>我们都非常清楚 APP 登录判断是个最常见不过的操作了，没有使用 AOP 之前，我们每次需要用户登录权限的操作前都要先去判断一下是否有登录，然后如果没有登录则进行跳转，我们有没有办法在一个地方对这个判断进行集中处理呢？</p>
<p>首先，我们需要搞清楚几个概念：</p>
<ol>
<li>连接点(Joint point)：所有的目标方法都是连接点</li>
<li>切入点(PointCut)：通过使用特定的表达式 过滤出来的 需要切入 Advice 的切入点，即所有连接点的集合。</li>
<li>通知(Advice)：Advice 向代码中植入 的实现方法（Before（前置）、After（后置） 、 Around（环绕））。</li>
<li>切面(Aspect): 由 PointCut  和 Advice 组成一个切面。</li>
</ol>
<p>光看这些概念性的东西肯定是不知所以然，下面我们来一步步的通过代码使用 AspectJ 来实现：</p>
<h4 id="添加插件"><a href="#添加插件" class="headerlink" title="添加插件"></a>添加插件</h4><p>在 Application 的 <code>build.gradle</code> 中添加插件<br><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">buildscript &#123;</span><br><span class="line">    dependencies &#123;</span><br><span class="line">            classpath <span class="string">'com.android.tools.build:gradle:3.2.1'</span></span><br><span class="line">    </span><br><span class="line">            <span class="comment">// 添加 aspectj 对应的插件</span></span><br><span class="line">            classpath <span class="string">'org.aspectj:aspectjtools:1.8.9'</span></span><br><span class="line">            classpath <span class="string">'org.aspectj:aspectjweaver:1.8.9'</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h4 id="APP-编译设置"><a href="#APP-编译设置" class="headerlink" title="APP 编译设置"></a>APP 编译设置</h4><p>在 app 的 <code>build.gradle</code> 中添加引用包，并设置编译时使用的插件，以及添加编译支持代码。<br><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br></pre></td><td class="code"><pre><span class="line">apply <span class="string">plugin:</span> <span class="string">'com.android.application'</span></span><br><span class="line"></span><br><span class="line">buildscript &#123; <span class="comment">// 编译时用Aspect专门的编译器，不再使用传统的javac</span></span><br><span class="line">    repositories &#123;</span><br><span class="line">        mavenCentral()</span><br><span class="line">    &#125;</span><br><span class="line">    dependencies &#123;</span><br><span class="line">        classpath <span class="string">'org.aspectj:aspectjtools:1.8.9'</span></span><br><span class="line">        classpath <span class="string">'org.aspectj:aspectjweaver:1.8.9'</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">android &#123;</span><br><span class="line">    compileSdkVersion <span class="number">29</span></span><br><span class="line">    buildToolsVersion <span class="string">"29.0.2"</span></span><br><span class="line">    defaultConfig &#123;</span><br><span class="line">        applicationId <span class="string">"com.example.myapplication"</span></span><br><span class="line">        minSdkVersion <span class="number">23</span></span><br><span class="line">        targetSdkVersion <span class="number">29</span></span><br><span class="line">        versionCode <span class="number">1</span></span><br><span class="line">        versionName <span class="string">"1.0"</span></span><br><span class="line">        testInstrumentationRunner <span class="string">"androidx.test.runner.AndroidJUnitRunner"</span></span><br><span class="line">    &#125;</span><br><span class="line">    buildTypes &#123;</span><br><span class="line">        release &#123;</span><br><span class="line">            minifyEnabled <span class="literal">false</span></span><br><span class="line">            proguardFiles getDefaultProguardFile(<span class="string">'proguard-android-optimize.txt'</span>), <span class="string">'proguard-rules.pro'</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">dependencies &#123;</span><br><span class="line">    implementation fileTree(<span class="string">dir:</span> <span class="string">'libs'</span>, <span class="string">include:</span> [<span class="string">'*.jar'</span>])</span><br><span class="line">    implementation <span class="string">'androidx.appcompat:appcompat:1.1.0'</span></span><br><span class="line">    implementation <span class="string">'androidx.constraintlayout:constraintlayout:1.1.3'</span></span><br><span class="line">    implementation <span class="string">'com.google.android.material:material:1.0.0'</span></span><br><span class="line">    implementation <span class="string">'androidx.annotation:annotation:1.0.2'</span></span><br><span class="line">    implementation <span class="string">'androidx.lifecycle:lifecycle-extensions:2.0.0'</span></span><br><span class="line">    testImplementation <span class="string">'junit:junit:4.12'</span></span><br><span class="line">    androidTestImplementation <span class="string">'androidx.test.ext:junit:1.1.1'</span></span><br><span class="line">    androidTestImplementation <span class="string">'androidx.test.espresso:espresso-core:3.2.0'</span></span><br><span class="line"></span><br><span class="line">    implementation <span class="string">'org.aspectj:aspectjrt:1.8.13'</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 编译支持</span></span><br><span class="line"><span class="keyword">import</span> org.aspectj.bridge.IMessage</span><br><span class="line"><span class="keyword">import</span> org.aspectj.bridge.MessageHandler</span><br><span class="line"><span class="keyword">import</span> org.aspectj.tools.ajc.Main</span><br><span class="line"></span><br><span class="line"><span class="keyword">final</span> <span class="keyword">def</span> log = project.logger</span><br><span class="line"><span class="keyword">final</span> <span class="keyword">def</span> variants = project.android.applicationVariants</span><br><span class="line"></span><br><span class="line">variants.all &#123; variant -&gt;</span><br><span class="line">    <span class="keyword">if</span> (!variant.buildType.isDebuggable()) &#123;</span><br><span class="line">        log.debug(<span class="string">"Skipping non-debuggable build type '$&#123;variant.buildType.name&#125;'."</span>)</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    JavaCompile javaCompile = variant.javaCompile</span><br><span class="line">    javaCompile.doLast &#123;</span><br><span class="line">        String[] args = [<span class="string">"-showWeaveInfo"</span>,</span><br><span class="line">                         <span class="string">"-1.8"</span>,</span><br><span class="line">                         <span class="string">"-inpath"</span>, javaCompile.destinationDir.toString(),</span><br><span class="line">                         <span class="string">"-aspectpath"</span>, javaCompile.classpath.asPath,</span><br><span class="line">                         <span class="string">"-d"</span>, javaCompile.destinationDir.toString(),</span><br><span class="line">                         <span class="string">"-classpath"</span>, javaCompile.classpath.asPath,</span><br><span class="line">                         <span class="string">"-bootclasspath"</span>, project.android.bootClasspath.join(File.pathSeparator)]</span><br><span class="line">        log.debug <span class="string">"ajc args: "</span> + Arrays.toString(args)</span><br><span class="line"></span><br><span class="line">        MessageHandler handler = <span class="keyword">new</span> MessageHandler(<span class="literal">true</span>);</span><br><span class="line">        <span class="keyword">new</span> Main().run(args, handler);</span><br><span class="line">        <span class="keyword">for</span> (IMessage <span class="string">message :</span> handler.getMessages(<span class="literal">null</span>, <span class="literal">true</span>)) &#123;</span><br><span class="line">            <span class="keyword">switch</span> (message.getKind()) &#123;</span><br><span class="line">                <span class="keyword">case</span> IMessage.<span class="string">ABORT:</span></span><br><span class="line">                <span class="keyword">case</span> IMessage.<span class="string">ERROR:</span></span><br><span class="line">                <span class="keyword">case</span> IMessage.<span class="string">FAIL:</span></span><br><span class="line">                    log.error message.message, message.thrown</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> IMessage.<span class="string">WARNING:</span></span><br><span class="line">                    log.warn message.message, message.thrown</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> IMessage.<span class="string">INFO:</span></span><br><span class="line">                    log.info message.message, message.thrown</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> IMessage.<span class="string">DEBUG:</span></span><br><span class="line">                    log.debug message.message, message.thrown</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>以上准备工作做好了，下面进入正餐。</p>
<h4 id="新增连接点标示"><a href="#新增连接点标示" class="headerlink" title="新增连接点标示"></a>新增连接点标示</h4><p>此处的连接点标示我们使用自定义注解来进行标注<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Target</span>(ElementType.METHOD)</span><br><span class="line"><span class="meta">@Retention</span>(RetentionPolicy.RUNTIME)</span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> LoginCheck &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h4 id="添加连接点"><a href="#添加连接点" class="headerlink" title="添加连接点"></a>添加连接点</h4><p>我们将用上一步的注解，在我们需要进行登录确认的方法前进行标示，例如如下方法会跳转我的专区页面，但是需要用户登录后才能跳转，我们则在这个方法上加上我们之前的注解：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 需要登录后操作，未登陆需要跳转登录界面</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> view</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@LoginCheck</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">area</span><span class="params">(View view)</span> </span>&#123;</span><br><span class="line">    Log.d(TAG, <span class="string">"跳转到我的专区界面"</span>);</span><br><span class="line">    startActivity(<span class="keyword">new</span> Intent(<span class="keyword">this</span>, MainActivity.class));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>那么如何让这个注解起作用呢？重点就在下一步，添加切面。</p>
<h4 id="添加切面"><a href="#添加切面" class="headerlink" title="添加切面"></a>添加切面</h4><p>我们新建一个类作为切面，其中包含了 切入点（PointCut）和 环绕通知（Around）：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.aspectj.lang.ProceedingJoinPoint;</span><br><span class="line"><span class="keyword">import</span> org.aspectj.lang.annotation.Around;</span><br><span class="line"><span class="keyword">import</span> org.aspectj.lang.annotation.Aspect;</span><br><span class="line"><span class="keyword">import</span> org.aspectj.lang.annotation.Pointcut;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 通过 <span class="doctag">@Aspect</span> 注解表明此类为一个切面</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Aspect</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LoginCheckAspect</span> </span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 定义切入点，通过 execution 语法定义哪些方法为切入点</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Pointcut</span>(<span class="string">"execution(@com.example.myapplication.example_login.aop.LoginCheck * *(..))"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">methondPointCut</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Around</span>(<span class="string">"methondPointCut()"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Object <span class="title">joinPoint</span><span class="params">(ProceedingJoinPoint joinPoint)</span> <span class="keyword">throws</span> Throwable </span>&#123;</span><br><span class="line">        Context context = (Context) joinPoint.getThis();</span><br><span class="line"></span><br><span class="line">        String loginedUser = SharedPreferencesUtil.getLoginedUser();</span><br><span class="line">        <span class="comment">// 如果记录用户名不为空，则说明已登录</span></span><br><span class="line">        <span class="keyword">boolean</span> isLogin = !TextUtils.isEmpty(loginedUser);</span><br><span class="line">        <span class="comment">// 判断是否登录</span></span><br><span class="line">        <span class="keyword">if</span> (!isLogin) &#123;</span><br><span class="line">            <span class="comment">// 未登录直接跳转到登录页面</span></span><br><span class="line">            Toast.makeText(context, <span class="string">"请先登录！"</span>, Toast.LENGTH_SHORT).show();</span><br><span class="line">            Intent intent = <span class="keyword">new</span> Intent(context, LoginActivity.class);</span><br><span class="line">            context.startActivity(intent);</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 如果登录了，则执行原方法</span></span><br><span class="line">        <span class="keyword">return</span> joinPoint.proceed();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>以上代码通过 @Pointcut（切入点） 和 @Around（通知） 形成了 一个 @Aspect（切面）。 这里需要注意，定义切入点时使用 execution 需要注意语法正确，否则会导致无法正确切入。</p>
<p>这样就使用 AspectJ 完成了一整套 集中式登录架构，接下来只需要在需要登录验证的方法前加上注解即可，相当于将登录验证从一个个纵向流程中横向给切了出来进行单独处理，可以减少了我们需要重复进行登录判断的冗余代码。  </p>
<p>我们还可以想一想，如果我们要用户的点击行为统计如何我们应当如何写呢？思路也是一样哈，定义连接点标示（自定义注解），新增切面类并在其中定义切入点和通知，在通知中做抽取的业务逻辑即可，在下面提供的源码地址中我也有实现哈，以供参考。</p>
<p>这就是 AOP 在 Android 中的应用，对于这个方法论你学会了吗？除此之外，你还有什么妙用吗？不妨实践一下。</p>
<p>源码链接：<a href="https://github.com/TYKevin/DemoAopInAndroid" target="_blank" rel="noopener">https://github.com/TYKevin/DemoAopInAndroid</a></p>

        </div>

        <blockquote class="post-copyright">
    
    <div class="content">
        
<span class="post-time">
    最后更新时间：<time datetime="2019-12-03T16:39:34.010Z" itemprop="dateUpdated">2019-12-04 00:39:34</time>
</span><br>


        
        原文链接：<a href="/2019/12/03/android/aop-in-android/" target="_blank" rel="external">http://TYKevin.github.io/2019/12/03/android/aop-in-android/</a>
        
    </div>
    
    <footer>
        <a href="http://TYKevin.github.io">
            <img src="/img/avatar.png" alt="童煜">
            童煜
        </a>
    </footer>
</blockquote>

        


        <div class="post-footer">
            
	<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/android-架构/">android 架构</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/android-进阶/">android 进阶</a></li></ul>


            
<div class="page-share-wrap">
    

<div class="page-share" id="pageShare">
    <ul class="reset share-icons">
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=http://TYKevin.github.io/2019/12/03/android/aop-in-android/&title=《重构登录管理 - AOP 思想在 Android 中的应用》 — Android 进阶指北&pic=http://TYKevin.github.io/img/avatar.png" data-title="微博">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="微信">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=http://TYKevin.github.io/2019/12/03/android/aop-in-android/&title=《重构登录管理 - AOP 思想在 Android 中的应用》 — Android 进阶指北&source=Talk is cheap, Show me the code" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=http://TYKevin.github.io/2019/12/03/android/aop-in-android/" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=《重构登录管理 - AOP 思想在 Android 中的应用》 — Android 进阶指北&url=http://TYKevin.github.io/2019/12/03/android/aop-in-android/&via=http://TYKevin.github.io" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=http://TYKevin.github.io/2019/12/03/android/aop-in-android/" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
    </ul>
 </div>



    <a href="javascript:;" id="shareFab" class="page-share-fab waves-effect waves-circle">
        <i class="icon icon-share-alt icon-lg"></i>
    </a>
</div>



        </div>
    </div>

    
<nav class="post-nav flex-row flex-justify-between flex-row-reverse">
  

  
    <div class="waves-block waves-effect next">
      <a href="/2019/05/09/android/android-custom-object-animation/" id="post-next" class="post-nav-link">
        <div class="tips">Next <i class="icon icon-angle-right icon-lg icon-pl"></i></div>
        <h4 class="title">深度解析属性动画的思想 - 带你手动实现属性动画框架</h4>
      </a>
    </div>
  
</nav>



    




















</article>



</div>

        <footer class="footer">
    <div class="top">
        
<p>
    <span id="busuanzi_container_site_uv" style="display:none">
        站点总访客数：<span id="busuanzi_value_site_uv"></span>
    </span>
    <span id="busuanzi_container_site_pv" style="display:none">
        站点总访问量：<span id="busuanzi_value_site_pv"></span>
    </span>
</p>


        <p>
            
                <span><a href="/atom.xml" target="_blank" class="rss" title="rss"><i class="icon icon-lg icon-rss"></i></a></span>
            
            <span>博客内容遵循 <a rel="license" href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh">知识共享 署名 - 非商业性 - 相同方式共享 4.0 国际协议</a></span>
        </p>
    </div>
    <div class="bottom">
        <p><span>童煜 &copy; 2018 - 2019</span>
            <span>
                
                Power by <a href="http://hexo.io/" target="_blank">Hexo</a> Theme <a href="https://github.com/yscoder/hexo-theme-indigo" target="_blank">indigo</a>
            </span>
        </p>
    </div>
</footer>

    </main>
    <div class="mask" id="mask"></div>
<a href="javascript:;" id="gotop" class="waves-effect waves-circle waves-light"><span class="icon icon-lg icon-chevron-up"></span></a>



<div class="global-share" id="globalShare">
    <ul class="reset share-icons">
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=http://TYKevin.github.io/2019/12/03/android/aop-in-android/&title=《重构登录管理 - AOP 思想在 Android 中的应用》 — Android 进阶指北&pic=http://TYKevin.github.io/img/avatar.png" data-title="微博">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="微信">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=http://TYKevin.github.io/2019/12/03/android/aop-in-android/&title=《重构登录管理 - AOP 思想在 Android 中的应用》 — Android 进阶指北&source=Talk is cheap, Show me the code" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=http://TYKevin.github.io/2019/12/03/android/aop-in-android/" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=《重构登录管理 - AOP 思想在 Android 中的应用》 — Android 进阶指北&url=http://TYKevin.github.io/2019/12/03/android/aop-in-android/&via=http://TYKevin.github.io" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=http://TYKevin.github.io/2019/12/03/android/aop-in-android/" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
    </ul>
 </div>


<div class="page-modal wx-share" id="wxShare">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <p>扫一扫，分享到微信</p>
    <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMYAAADGCAAAAACs8KCBAAACHElEQVR42u3aS27DMAwFwN7/0u4BCjuPpB3U0mgVBImj6YLl7+cnPsefk3zm+pNnr8++dcPBwMB4LeO4PPkVq8jkycndMDAw9mH0wmIPdv3O2esPd8bAwMC4TNfuCtkYGBgYTwTcuwrj63cwMDAw8nCZN+CqV/xqLY6BgfFCRh4cv//6kfkGBgbGqxhH8dxF7TXyTm+FgYGxNCMPcJMUsDdOKN8HAwNjUUa1aMybbvkAoFrWlvt2GBgYL2dUfzhq0MdPztt5heEEBgbGooxqYK2uSsyXNkZNNwwMjJcz8jKyt8KVr4X1fhEDA2MHRrWhVk3yehcdJawYGBjLMaqF5SThmyNP38HAwNiYUV2byIcNeUCPfh0DA2NpRn6Sa00CaB7EmwAMDIyXM+5qk/VWJW4rgDEwMBZl5CPDSbOsmjiOMlwMDIzlGPNW2qSg7Y02m4NMDAyMJRhJKlZducgTx+qyRVTKYmBgLMTotb0m6xF5wlcIxBgYGNswJsVndZyQXzdqw2FgYGzJqDb381K22s6Lpq8YGBjbMCaJXS99vC3pxMDAWJRxFM8TQXZUuGJgYGzAmITI+TAgz/GaySIGBsZCjN5KVrUZl//98oCLgYGxG6NarCZRfL7+1Vy2wMDAwLiplVYN61FFjoGBgZE8rsjrJaaP/N/AwMD494zJ2lZ1aaM3SPjweQwMjKUZ+dd6rbfkmfPhBAYGxqKMXzgqS6k9LHGxAAAAAElFTkSuQmCC" alt="微信分享二维码">
</div>




    <script src="//cdn.bootcss.com/node-waves/0.7.4/waves.min.js"></script>
<script>
var BLOG = { ROOT: '/', SHARE: true, REWARD: false };


</script>

<script src="/js/main.min.js?v=1.7.2"></script>


<div class="search-panel" id="search-panel">
    <ul class="search-result" id="search-result"></ul>
</div>
<template id="search-tpl">
<li class="item">
    <a href="{path}" class="waves-block waves-effect">
        <div class="title ellipsis" title="{title}">{title}</div>
        <div class="flex-row flex-middle">
            <div class="tags ellipsis">
                {tags}
            </div>
            <time class="flex-col time">{date}</time>
        </div>
    </a>
</li>
</template>

<script src="/js/search.min.js?v=1.7.2" async></script>






<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>





</body>
</html>
